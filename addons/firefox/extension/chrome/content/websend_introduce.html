<html>
<style>
BODY {
  font: small-caption;
  corner-radius:4px;
}
#provider_list {
  margin-top:6px;
  padding:4px;
}
.provider {
  display: inline-block;
  cursor: pointer;
  -moz-transition:background-color 0.25s
}
.provider:hover {
  background-color:blue;/*#e0e0e0;
  -moz-transition:background-color 0.25s*/
}
.provider > img {
  float:left;
}
.label {
  padding-left:30px;
  padding-top:2px;
}
#header {
  color:#909090
}
</style>
<body onload="init()">

<div id="header">Select provider:</div>

<div id="provider_list">
</div>

<script>
document.render = function() { 
  var container = document.getElementById("provider_list");
  
  for each (var p in providers)
  {
      var div = document.createElement("div");
      div.classList.add("provider");
      var img = document.createElement("img");
      img.style.width= "24px";
      img.style.height= "24px";
      img.src = p.icons[128];
      div.appendChild(img);
      var label = document.createElement("div");
      label.classList.add("label");
      label.appendChild(document.createTextNode(p.name));
      div.appendChild(label);
      container.appendChild(div);
      div.onclick = createOnClickFn(p.id);
  }
}
function createOnClickFn(id) {
  return function() {
    dump("clicked " + id + "\n");
    window.parent.postMessage("clicked:" + id, "*" /* WHAT? */);
  } 
}

var providers=  [];
function init() {
  window.addEventListener("message", function(arg) {
    providers = JSON.parse(arg.data);
    document.render();
  }, false);
}


</script>
</body>
</html>